<p><%= t('advice_pages.gas_recent_changes.analysis.summary') %></p>

<p><%= t('advice_pages.gas_recent_changes.analysis.sections') %></p>

<ul>
  <li><%= link_to(t('advice_pages.gas_recent_changes.analysis.compare_recent_weeks.title'), '#compare-recent-weeks') %></li>
  <li><%= link_to(t('advice_pages.gas_recent_changes.analysis.compare_recent_days.title'), '#compare-recent-days') %></li>
  <li><%= link_to(t('advice_pages.gas_recent_changes.analysis.impact_of_temperature.title'), '#impact-of-temperature') %></li>
</ul>

<!--  COMPARISON OF GAS USE OVER 2 RECENT WEEKS -->
<%= render 'schools/advice/section_title', section_id: 'compare-recent-weeks', section_title: t('advice_pages.gas_recent_changes.analysis.compare_recent_weeks.title') %>

<div class="charts">
  <%= render(ChartComponent.new(
    chart_type: :calendar_picker_gas_week_example_comparison_chart,
    school: @school,
    analysis_controls: false,
    no_zoom: true,
    chart_config: @chart_config,
    html_class: 'usage-chart')) do |c| %>
    <% c.with_title { t('advice_pages.gas_recent_changes.analysis.charts.compare_recent_weeks_chart_title') } %>
    <% c.with_subtitle { t('advice_pages.gas_recent_changes.analysis.charts.compare_recent_weeks_chart_subtitle') } %>
    <% c.with_header do %>
      <p><%= t('advice_pages.gas_recent_changes.analysis.charts.compare_recent_weeks_chart_explanation') %></p>
    <% end %>
    <% c.with_footer do %>
      <%= render 'shared/usage_controls', chart_config: @chart_config, period: :weekly, supply: :gas, split_meters: false, meters: @meters %>
    <% end %>
  <% end %>
</div>

<!--  COMPARISON OF GAS USE OVER 2 RECENT DAYS -->
<%= render 'schools/advice/section_title', section_id: 'compare-recent-days', section_title: t('advice_pages.gas_recent_changes.analysis.compare_recent_days.title') %>

<div class="charts">
  <%= render(ChartComponent.new(
    chart_type: :calendar_picker_gas_day_example_comparison_chart,
    school: @school,
    analysis_controls: false,
    no_zoom: true,
    chart_config: @chart_config,
    axis_controls: false,
    html_class: 'usage-chart')) do |c| %>
    <% c.with_title { t('advice_pages.gas_recent_changes.analysis.charts.compare_recent_days_chart_title') } %>
    <% c.with_subtitle { t('advice_pages.gas_recent_changes.analysis.charts.compare_recent_days_chart_subtitle') } %>
    <% c.with_header do %>
      <p><%= t('advice_pages.gas_recent_changes.analysis.charts.compare_recent_days_chart_explanation') %></p>
    <% end %>
    <% c.with_footer do %>
      <%= render 'shared/usage_controls', chart_config: @chart_config, period: :daily, supply: :gas, split_meters: false, meters: @meters  %>
      <p><%= t('advice_pages.gas_recent_changes.analysis.expected_usage_patterns') %></p>
      <p><%= t('advice_pages.gas_recent_changes.analysis.optimal_start_control') %></p>
    <% end %>
  <% end %>
</div>

<!--  IMPACT ON GAS USE OF TEMP -->
<%= render 'schools/advice/section_title', section_id: 'impact-of-temperature', section_title: t('advice_pages.gas_recent_changes.analysis.impact_of_temperature.title') %>

<div class="xcharts">
  <%= render(ChartComponent.new(
    chart_type: :last_2_weeks_gas_degreedays,
    school: @school,
    analysis_controls: true,
    no_zoom: true,
    chart_config: @chart_config,
    axis_controls: false)) do |c| %>
    <% c.with_title { t('advice_pages.gas_recent_changes.analysis.charts.impact_of_temperature_chart_title') } %>
    <% c.with_subtitle { t('advice_pages.gas_recent_changes.analysis.charts.impact_of_temperature_chart_subtitle', start_date: short_dates(@chart_config[:last_reading] - 13.days), end_date: short_dates(@chart_config[:last_reading])) } %>
    <% c.with_footer do %>
      <p><%= t('advice_pages.gas_recent_changes.analysis.charts.impact_of_temperature_chart_explanation_html', url: "https://www.sustainabilityexchange.ac.uk/files/degree_days_for_energy_management_carbon_trust.pdf") %></p>
    <% end %>
  <% end %>
</div>
