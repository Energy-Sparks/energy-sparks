<% content_for :page_title, "#{t('advice_pages.index.title')} | #{@school.name}" %>

<% content_for :dashboard_header do %>
  <div class="row dashboard-header-component adult">
    <div class="col-12 col-md-9">
      <div class="row">
        <div class="col">
          <h1><%= t('advice_pages.index.title') %></h1>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <p>
            <%= t('advice_pages.index.show.intro') %>
          </p>
        </div>
      </div>
    </div>
  </div>
<% end %>

<div class="container">
  <div class="row mt-2">
    <div class="col-md-3 col-lg-3 col-xl-2 advice-page-nav">
      <%= render 'schools/advice/nav', school: @school, advice_pages: @advice_pages %>
    </div>
    <div class="col-md-9 col-lg-9 col-xl-10">

      <h2><%= t('schools.show.recent_energy_usage') %></h2>

      <% if @overview_charts&.any? %>
        <%= render 'management/schools/overview_charts', overview_charts: @overview_charts %>
      <% end %>

      <%= component 'advice_page_list', id: 'energy-explained', classes: 'mt-4 mb-4', school: @school %>

      <div id='whats-next mt-4'>
        <%= component 'titled_section' do |section| %>
          <% section.with_title do %>
            <h2><%= t('advice_pages.index.show.what_next') %></h2>
          <% end %>
          <% section.with_body do %>
            <%= component 'prompt', icon: 'tasks', status: :none, style: :compact do |p| %>
              <% p.with_title do %>
                <%= t('advice_pages.insights.recommendations.actions_title') %>
              <% end %>
              <% p.with_link do %>
                <%= link_to t('common.labels.choose_activity'), school_recommendations_path(@school, scope: :adult) %>
              <% end %>
              <%= t('schools.prompts.recommendations.message') %>
            <% end %>
            <%= component 'prompt', icon: 'tachometer-alt', status: :none, style: :compact do |p| %>
              <% p.with_title do %>
                <%= t('schools.show.set_target') %>
              <% end %>
              <% p.with_link do %>
                <%= link_to t('schools.show.set_target'), school_school_targets_path %>
              <% end %>
              <%= t('schools.show.set_targets') %>
            <% end %>
            <%= component 'prompt', icon: 'bell', status: :none, style: :compact do |p| %>
              <% p.with_title do %>
                <%= t('schools.school_targets.achieving_your_targets.view_recent_alerts') %>
              <% end %>
              <% p.with_link do %>
                <%= link_to t('common.labels.view_alerts'), alerts_school_advice_path(@school) %>
              <% end %>
              <%= t('schools.prompts.alerts.message') %>
            <% end %>
            <%= component 'prompt', icon: 'list', status: :none, style: :compact do |p| %>
              <% p.with_title do %>
                <%= t('schools.school_targets.achieving_your_targets.view_energy_saving_opportunities') %>
              <% end %>
              <% p.with_link do %>
                <%= link_to t('common.labels.view_opportunities'), priorities_school_advice_path(@school) %>
              <% end %>
              <%= t('schools.prompts.opportunities.message') %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<% if @electricity_benchmarked_usage.present? || @gas_benchmarked_usage.present? %>
  <div class="container-fluid bg-light pt-3 pb-3 mt-4">
    <div class="container">
      <div class="row">
        <div class="col-12 offset-md-2 offset-xl-2 col-md-9 col-lg-9 col-xl-10">
          <%= component 'titled_section' do |section| %>
            <%= section.with_title do %>
              <h2><%= t('advice_pages.total_energy_use.insights.comparison.title') %></h2>
            <% end %>
            <%= section.with_intro do %>
              <p>Use our comparison tool to compare your energy use with others in your Multi-Academy Trust.</p>
            <% end %>
            <%= section.with_link do %>
              <p>
              <%= link_to t('schools.schools.compare_schools'),
                          "#{compare_index_path(school_group_ids: [@school.school_group.id])}#groups",
                          class: 'btn btn-outline-dark' %>
              </p>
            <% end %>
            <% section.with_body do %>
              <% if @electricity_benchmarked_usage.present? %>
                <h4><%= t('common.electricity') %></h4>
                <p>
                  <%= t('advice_pages.electricity_long_term.insights.comparison.how_do_you_compare',
                        school_type: t("common.school_types.#{@school.school_type}")) %>
                </p>
                <div class="col">
                  <%= component 'school_comparison',
                                id: 'electricity-comparison',
                                comparison: @electricity_benchmarked_usage do |c| %>
                    <% c.with_footer { advice_t('electricity_long_term.insights.comparison.callout_footer') } %>
                  <% end %>
                </div>
              <% end %>

              <% if @gas_benchmarked_usage.present? %>
                <h4><%= t('common.gas') %></h4>
                <p>
                  <%= t('advice_pages.gas_long_term.insights.comparison.how_do_you_compare',
                        school_type: t("common.school_types.#{@school.school_type}")) %>
                </p>
                <div class="col">
                  <%= component 'school_comparison',
                                id: 'gas-comparison',
                                comparison: @gas_benchmarked_usage do |c| %>
                    <% c.with_footer { advice_t('gas_long_term.insights.comparison.callout_footer') } %>
                  <% end %>
                </div>
              <% end %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
<% end %>
