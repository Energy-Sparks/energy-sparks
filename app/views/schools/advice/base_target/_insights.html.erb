<%= render PromptComponent.new(status: :none, icon: :lightbulb) do |c| %>
  <%= t('advice_pages.target.insights.what_is_your_target.text_html',
        fuel_type: @advice_page.fuel_type&.to_sym,
        percent: format_unit(@target.electricity, { units: :percent, options: { scale: false } }),
        target_date: @target.target_date.strftime('%B %Y')) %>
<% end %>
<%= render 'schools/advice/section_title',
           section_id: 'progress',
           section_title: t('advice_pages.target.insights.your_current_progress.title') %>
<%= render 'meeting_target_prompt' %>
<% if can?(:manage, @target) %>
  <%= link_to t('schools.school_targets.title.revise_your_target'),
              edit_school_school_target_path(@target.school, @target), class: 'btn btn-default' %>
<% end %>
<table class="mt-2 table table-sm advice-table">
  <thead>
    <th><%= t('advice_pages.tables.columns.period') %></th>
    <th><%= t('advice_pages.target.insights.your_current_progress.cumulative_consumption') %></th>
    <th><%= t('advice_pages.target.insights.your_current_progress.target_consumption') %></th>
    <th class="text-right"><%= t('advice_pages.baseload.current_baseload.tables.columns.percentage_change') %></th>
  </thead>
  <tbody>
    <tr>
      <td><%= format_date_range([@target.start_date, Date.new(@last_consumption_month[:year],
                                                              @last_consumption_month[:month]).end_of_month]) %></td>
      <td><%= format_unit(@current_consumption, :kw) %></td>
      <td><%= format_unit(@target_consumption, :kw) %></td>
      <td td class="text-right">
        <%= up_downify(format_unit(percent_change(@current_consumption, @target_consumption), :relative_percent),
                       sanitize: false) %></td>
    </tr>
  </tbody>
</table>
<%= render 'schools/advice/how_have_we_analysed_your_data_table_caption' %>
<%= t('advice_pages.target.insights.your_current_progress.text_html',
      analysis_path: electricity_target_analysis_school_advice_path(@school),
      comparison_path: benchmarks_compare_index_path) %>
