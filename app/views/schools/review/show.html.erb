<%= content_for :page_title, t('schools.show.dashboard_title', school_name: @school.name) %>

<% content_for :dashboard_header do %>
  <%= render DashboardHeaderComponent.new school: @school, audience: :adult, title: 'schools.review.title', intro: nil %>
<% end %>

<div class="container">
  <div class='mt-4 d-flex justify-content-end align-items-baseline'>
    <span class="badge border badge-pill border-secondary font-weight-normal">
      <%= link_to 'View school issues', polymorphic_url([:admin, @school, Issue]), class: 'text-decoration-none' %>
    </span>
    &nbsp;
    <% if current_user.admin? && @school&.school_group %>
      <%= render 'admin/school_groups/default_issues_admin_user', school_group: @school&.school_group %>
    <% end %>
  </div>

  <%= render 'prompts',
             section_id: 'errors',
             title: 'Errors',
             prompts: @errors,
             status: :negative,
             icon: 'exclamation' %>

  <%= render 'prompts',
             section_id: 'warnings',
             title: 'Warnings',
             prompts: @warnings,
             status: :neutral,
             icon: 'question' %>

  <div class="row mt-4 mb-4">
    <div class="col">
      <% if can?(:change_data_processing, @school) %>
        <% if @school.process_data? %>
          <%= link_to 'Process data',
                      school_data_processing_path(@school),
                      class: 'btn btn-success',
                      method: :delete,
                      data: { confirm: 'Are you sure?' } %>
        <% else %>
          <%= link_to 'Process data',
                      school_data_processing_path(@school),
                      class: 'btn btn-danger',
                      method: :post,
                      data: { confirm: 'Are you sure?' } %>
        <% end %>
      <% end %>

      <% if can?(:change_data_enabled, @school) %>
        <% if @school.data_enabled? %>
          <%= link_to 'Data visible',
                      school_data_enabled_path(@school),
                      class: 'btn btn-success',
                      method: :delete,
                      data: { confirm: 'Are you sure?' } %>
        <% else %>
          <%= link_to 'Data visible',
                      school_data_enabled_path(@school),
                      class: 'btn btn-danger',
                      method: :post,
                      data: { confirm: 'Are you sure?' } %>
        <% end %>
      <% end %>
    </div>
  </div>

</div>
