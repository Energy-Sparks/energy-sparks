<%= render 'schools/transport_surveys/header_nav' %>
<%= render 'schools/transport_surveys/tab_nav' %>

<% if @transport_survey.responses.any? %>
  <div class="table-responsive mt-2">
    <table class="table table-striped">
      <thead>
        <tr>
          <th><%= t('schools.transport_surveys.common.weather') %></th>
          <th><%= t('schools.transport_surveys.common.journey_time') %></th>
          <th><%= t('schools.transport_surveys.common.transport_method') %></th>
          <th><%= t('schools.transport_surveys.common.passengers') %></th>
          <th><%= t('schools.transport_surveys.common.carbon') %></th>
          <th><%= t('schools.transport_surveys.common.survey_time') %></th>
          <% if can? :delete, TransportSurveyResponse %>
            <th><%= t('common.labels.actions') %></th>
          <% end %>
        </tr>
      </thead>
      <tbody>
        <% @responses.each do |response| %>
          <tr scope="row">
            <td><%= response.weather_symbol %></td>
            <td><%= response.journey_minutes %> <%= t('schools.transport_surveys.common.mins') %></td>
            <td><%= response.transport_type.image %> <%= response.transport_type.name %></td>
            <td><%= response.passengers > 1 ? response.passengers : "" %></td>
            <td><%= response.carbon.round(3) %>kg CO2</td>
            <td><%= nice_date_times response.surveyed_at.localtime %></td>
            <% if can? :delete, response %>
              <td><%= link_to t('common.labels.delete'), school_transport_survey_response_path(@school, @transport_survey, response), method: :delete, data: { confirm:  t('common.confirm') }, class: 'btn btn-sm btn-danger' %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <h4><%= t('schools.transport_surveys.common.no_responses') %></h4>
<% end %>

<%= render "schools/transport_surveys/pagy" %>
