<%= render 'schools/transport_surveys/header_nav' %>
<%= render 'schools/transport_surveys/tab_nav' %>

<% if @transport_survey.responses.any? %>
  <div class="table-responsive mt-2">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Weather</th>
          <th>Journey time</th>
          <th>Transport method</th>
          <th>Pupils sharing</th>
          <th>Carbon</th>
          <th>Survey time</th>
          <% if can? :delete, TransportSurveyResponse %>
            <th>Actions</th>
          <% end %>
        </tr>
      </thead>
      <tbody>
        <% @responses.each do |response| %>
          <tr scope="row">
            <td><%= response.weather_symbol %></td>
            <td><%= response.journey_minutes %> mins</td>
            <td><%= response.transport_type.image %> <%= response.transport_type.name %></td>
            <td><%= response.passengers > 1 ? response.passengers : "" %></td>
            <td><%= response.carbon.round(3) %>kg CO2</td>
            <td><%= nice_date_times response.surveyed_at.localtime %></td>
            <% if can? :delete, response %>
              <td><%= link_to 'Delete', school_transport_survey_response_path(@school, @transport_survey, response), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-sm btn-danger' %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <h4>No responses have been collected</h4>
<% end %>

<%= render "schools/transport_surveys/pagy" %>
