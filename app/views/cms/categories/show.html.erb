<%= content_for :page_title, 'Support Pages' %>

<% content_for :dashboard_header do %>
  <%= render Layout::Cards::PageHeaderComponent.new(
        title: @category.title,
        subtitle: @category.description
      ) %>
<% end %>

<div class="container">
  <%= render 'cms/search' %>

  <div class="row mt-2">
    <div id="page-navigation" class="col-md-4 col-lg-4 col-xl-3">
      <%= render 'cms/nav', categories: @categories, current_category: @category, classes: '' %>
    </div>

    <div id="page-body" class="col-md-8 col-lg-8 col-xl-9">
      <% scope = current_user&.admin? ? @category.pages : @category.pages.published %>
      <% scope.by_title.each do |page| %>
        <div class="<%= class_names('page-card', { published: page.published }) %>">
          <h3><%= link_to page.title, page_path(page) %></h3>
          <p><%= page.description %></p>
          <ul>
            <% page_scope = current_user&.admin? ? page.sections : page.sections.published %>
            <% page_scope.positioned.each do |section| %>
              <li><%= link_to section.title,
                              page_path(page, anchor: section.slug,
                                              class: class_names('section-link', { published: section.published })) %></li>
            <% end %>
          </ul>
        </div>
      <% end %>
    </div>
  </div>
</div>
