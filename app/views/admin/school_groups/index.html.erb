<h1>Manage School Groups</h1>
<%= link_to 'New School group', new_admin_school_group_path, class: 'btn btn-primary' %>
<p></p>
<% if @school_groups.any? %>
  <table class="table table-condensed table-sorted">
    <thead>
      <tr>
        <th>Name</th>
        <th title="Schools onboarding">Onboarding</th>
        <th title="Schools active (without data visible)">Active</th>
        <th title="Schools active (with data visible)" class='nowrap'>Data visible</small></th>
        <th title="Schools invisible">Invisible</th>
        <th title="Schools removed">Removed</th>
        <th class="no-sort"></th>
      </tr>
    </thead>

    <tbody>
      <% @school_groups.each do |school_group| %>
        <tr>
          <td><%= link_to school_group.name, admin_school_group_path(school_group) %></td>
          <td><%= school_group.school_onboardings.select(&:incomplete?).count %></td>
          <td><%= school_group.schools.visible.count %></td>
          <td><%= school_group.schools.visible.data_enabled.count %></td>
          <td><%= school_group.schools.not_visible.count %></td>
          <td><%= school_group.schools.inactive.count %></td>
          <td class="nowrap">
            <%= link_to 'Edit', edit_admin_school_group_path(school_group), class: 'btn btn-sm' %>
            <%= link_to 'Meter attributes', admin_school_group_meter_attributes_path(school_group), class: 'btn btn-sm' %>
            <%= link_to 'Manage Partners', admin_school_group_partners_path(school_group), class: 'btn btn-sm' %>
            <%= link_to 'Delete', admin_school_group_path(school_group), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-sm btn-danger' %>
          </td>
        </tr>
      <% end %>
      <tr class="font-weight-bold">
        <td>All Energy Sparks Schools</td>
        <td><%= SchoolOnboarding.all.select(&:incomplete?).count %></td>
        <td><%= School.visible.count %></td>
        <td><%= School.visible.data_enabled.count %></td>
        <td><%= School.not_visible.count %></td>
        <td><%= School.inactive.count %></td>
        <td></td>
      </tr>
    </tbody>
  </table>
<% else %>
  <h2>There are no School groups</h2>
<% end %>
