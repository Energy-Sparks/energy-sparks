<div id='<%= task_type %>'>
  <% if (todos = assignable.todos.by_task_type(task_type).positioned).any? %>
    <h3><%= label %></h3>
    <% todos.each_with_index do |todo, idx| %>
      <% recording = todo.recording_for(completable: completable) if completable %>
      <% icon = if completable
                  recording ? 'circle-check text-success far' : 'circle text-muted far'
                else
                  (idx + 1).to_s
                end %>
      <%= render PromptComponent.new(icon: icon, status: recording ? :positive : :none) do |c| %>
        <p>
          <%= todo.notes %>
        </p>
        <% c.with_title do %>
          <%= todo.task.name %>
        <% end %>
        <% c.with_pill do %>
          <%= render 'shared/tasks/score', task: todo.task %>
        <% end %>
        <% c.with_link do %>
          <% if completable %>
            <% if recording %>
              <%= link_to "Completed on #{nice_dates(recording.happened_on)}", recording_path(recording) %>
            <% else %>
              <%= link_to 'Complete task', polymorphic_path(todo.task) %>
            <% end %>
          <% else %>
            <%= link_to 'View task', polymorphic_path(todo.task) %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</div>
