<!DOCTYPE html>
<html lang="<%= I18n.locale %>">
  <head>
    <%= render 'shared/head' %>
  </head>
  <body vocab="http://schema.org/" class="<%= 'sub-nav' if show_sub_nav?(@school || @tariff_holder, @hide_subnav) %>">
    <% if show_sub_nav?(@school, @hide_subnav) %>
      <%= render 'shared/mini_nav' %>
      <%= render 'shared/sub_nav', podium: current_school_podium, school: @school || @tariff_holder %>
    <% elsif @tariff_holder&.school? && show_sub_nav?(@tariff_holder, @hide_subnav) %>
      <%= render 'shared/mini_nav' %>
      <%= render 'shared/sub_nav', podium: current_school_podium, school: @tariff_holder %>
    <% elsif  @school_group && EnergySparks::FeatureFlags.active?(:enhanced_school_group_dashboard) && request.path.starts_with?('/school_groups') && can?(:update_settings, @school_group) %>
      <%= render 'shared/mini_nav' %>
      <%= render('school_groups/sub_nav', school_group: @school_group) if can?(:update_settings, @school_group || @tariff_holder) %>
    <% elsif @tariff_holder&.school_group? && EnergySparks::FeatureFlags.active?(:enhanced_school_group_dashboard) && request.path.starts_with?('/school_groups') && can?(:update_settings, @tariff_holder) %>
      <%= render 'shared/mini_nav' %>
      <%= render('school_groups/sub_nav', school_group: @tariff_holder) if can?(:update_settings, @tariff_holder) %>
    <% else %>
      <%= render 'shared/nav' %>
    <% end %>

    <div class="application container<%= conditional_application_container_classes %>">
      <% if show_sub_nav?(@school, @hide_subnav) || show_sub_nav?(@tariff_holder, @hide_subnav) || request.path.starts_with?('/school_groups') %>
        <div class="page-breadcrumb">
          <%= component 'breadcrumbs' do |c| %>
            <% c.with_school(@school) if @school %>
            <% if @breadcrumbs.present? && @breadcrumbs.any? %>
              <% c.with_items(@breadcrumbs) %>
            <% end %>
          <% end %>
        </div>
      <% end %>

      <%= render 'shared/alerts' if flash.any? %>
      <%= yield %>
    </div>
    <% if show_partner_footer?(@school) %>
      <%= render 'shared/partners' %>
    <% end %>
    <%= render 'shared/footer' %>
  </body>
  <%= render 'layouts/set_mobility_locale' %>
</html>
