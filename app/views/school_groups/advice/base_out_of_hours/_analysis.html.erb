<p><%= t("school_groups.advice_pages.#{@advice_page_key}.analysis.summary") %></p>

<ul>
  <li>
    <%= link_to(t("school_groups.advice_pages.#{@advice_page_key}.analysis.potential_savings.title"),
                '#potential-savings') %>
  </li>
  <li>
    <%= link_to(t("school_groups.advice_pages.#{@advice_page_key}.analysis.comparisons.title"), '#comparison') %>
  </li>
  <li>
    <%= link_to(t('school_groups.advice_pages.analysis.other_reports.title'), '#other-reports') %>
  </li>
</ul>

<%= render 'schools/advice/section_title',
           section_id: 'potential-savings',
           section_title: t("school_groups.advice_pages.#{@advice_page_key}.analysis.potential_savings.title") %>

<%= t("school_groups.advice_pages.#{@advice_page_key}.analysis.potential_savings.table.header_html",
      modal_id: SchoolGroups::AdviceController::MODAL_ID) %>

<%= render 'school_groups/advice/shared/savings_table', school_group: @school_group,
                                                        categorised_savings: @categorised_savings,
                                                        advice_page: @advice_page,
                                                        schools: @schools %>

<%= render 'schools/advice/section_title',
           section_id: 'comparison',
           section_title: t("school_groups.advice_pages.#{@advice_page_key}.analysis.comparisons.title") %>

<%= render Charts::GroupComparisonChartComponent.new(school_group: @school_group,
                                                     report: @report,
                                                     classes: 'mb-4') do |c| %>
  <% c.with_title { I18n.t("school_groups.advice_pages.#{@advice_page_key}.analysis.comparisons.chart.title") } %>
  <% c.with_subtitle { I18n.t("school_groups.advice_pages.#{@advice_page_key}.analysis.comparisons.chart.subtitle") } %>
  <% c.with_header { I18n.t("school_groups.advice_pages.#{@advice_page_key}.analysis.comparisons.chart.header") } %>
  <% c.with_footer do %>
    <%= render 'school_groups/advice/shared/analysis_footnotes_link' %>
  <% end %>
<% end %>

<%= t("school_groups.advice_pages.#{@advice_page_key}.analysis.comparisons.table.header_html") %>

<%= render "comparisons/#{@report.key}/table",
           results: @results,
           report: @report,
           advice_page: @advice_page,
           table_name: :table,
           index_params: index_params,
           headers: @report_headers,
           colgroups: [],
           advice_page_tab: @advice_page_tab,
           table_classes: comparison_table_class(@results),
           table_number: 0 %>

<%= render 'schools/advice/section_title',
           section_id: 'other-reports',
           section_title: t('school_groups.advice_pages.analysis.other_reports.title') %>

<p>
 <%= t('school_groups.advice_pages.analysis.other_reports.introduction') %>
</p>

<%= render SchoolGroups::ComparisonReportListComponent.new(school_group: @school_group,
                                                           fuel_types: @fuel_types) do |list| %>
  <% list.with_fuel_types t('school_groups.advice.comparison_reports.links.annual_change'), reports: {
       electricity: :change_in_electricity_since_last_year,
       gas: :change_in_gas_since_last_year,
       storage_heaters: :change_in_storage_heaters_since_last_year
     } %>
  <% list.with_fuel_types t('school_groups.advice.comparison_reports.links.last_two_holidays'), reports: {
       electricity: :change_in_electricity_holiday_consumption_previous_holiday,
       gas: :change_in_gas_holiday_consumption_previous_holiday
     } %>
  <% list.with_fuel_types t('school_groups.advice.comparison_reports.links.same_holiday'), reports: {
       electricity: :change_in_electricity_holiday_consumption_previous_years_holiday,
       gas: :change_in_gas_holiday_consumption_previous_years_holiday
     } %>
  <% list.with_fuel_types t('school_groups.advice.comparison_reports.links.current_holiday'), reports: {
       electricity: :electricity_consumption_during_holiday,
       gas: :gas_consumption_during_holiday,
       storage_heaters: :storage_heater_consumption_during_holiday
     } %>
  <% list.with_link t('school_groups.advice.comparison_reports.links.upcoming_holiday'),
                    report: :holiday_usage_last_year %>
<% end %>
