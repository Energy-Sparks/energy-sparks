<% if current_user.admin? %>
  <div class='row mb-2'>
    <div class="col d-flex justify-content-end align-items-baseline">
        <%= render 'admin/school_groups/default_issues_admin_user', school_group: @school_group %>
        <%= if @school_group.issues.status_open.any?
              link_to "View school group issues (#{@school_group.issues.status_open.count})",
                      admin_school_group_issues_path(school_group_id: @school_group.slug),
                      class: 'btn btn-sm btn-secondary'
            end %>
    </div>
  </div>
<% end %>

<% if can? :manage, DashboardMessage %>
  <%= render 'admin/shared/dashboard_message', messageable: @school_group %>
<% elsif @school_group.dashboard_message %>
  <%= render PromptComponent.new(icon: 'info-circle', style: :compact, status: :negative) do |p| %>
    <%= @school_group.dashboard_message.message %>
  <% end %>
<% end %>

<%= render TitledSectionComponent.new(id: 'settings-section', classes: 'scrollable-title') do |section| %>
  <% section.with_title do %>
    <h2><%= t('components.manage_school_navigation.settings') %></h2>
  <% end %>
  <% section.with_body do %>
    <%= render PromptComponent.new(icon: 'chart-line', style: :compact, status: :none) do |p| %>
      <% p.with_title { t('school_groups.sub_nav.chart_settings') } %>
      <% p.with_link { link_to t('common.labels.manage'), school_group_chart_updates_path(@school_group) } %>
      <%= t('school_groups.settings.charts') %>
    <% end %>

    <%= render PromptComponent.new(icon: 'users', style: :compact, status: :none) do |p| %>
      <% p.with_title { t('school_groups.sub_nav.clusters') } %>
      <% p.with_link { link_to t('common.labels.manage'), school_group_clusters_path(@school_group) } %>
      <%= t('school_groups.settings.clusters') %>
    <% end %>
  <% end %>
<% end %>

<%= render TitledSectionComponent.new(id: 'metering-section', classes: 'scrollable-title') do |section| %>
  <% section.with_title do %>
    <h2><%= t('components.manage_school_navigation.metering') %></h2>
  <% end %>
  <% section.with_body do %>
    <%= render PromptComponent.new(icon: 'sterling-sign', style: :compact, status: :none) do |p| %>
      <% p.with_title { t('manage_school_menu.manage_tariffs') } %>
      <% p.with_link { link_to t('common.labels.manage'), school_group_energy_tariffs_path(@school_group) } %>
      <%= t('school_groups.settings.tariffs') %>
    <% end if can? :manage, EnergyTariff %> <%# not sure if this is needed. Copied from school page %>
  <% end %>
<% end %>

<%= render TitledSectionComponent.new(id: 'reports-section', classes: 'scrollable-title') do |section| %>
  <% section.with_title do %>
    <h2><%= t('school_groups.titles.reports') %></h2>
  <% end %>
  <% section.with_body do %>
    <%= render PromptComponent.new(icon: 'table', style: :compact, status: :none) do |p| %>
      <% p.with_title { t('school_groups.sub_nav.secr_report') } %>
      <% p.with_link { link_to t('common.labels.view'), school_group_secr_index_path(@school_group) } %>
      <%= t('school_groups.settings.secr') %>
    <% end if Flipper.enabled?(:school_group_secr_report,  current_user) && @school_group.organisation? %>

    <%= render PromptComponent.new(icon: 'square-check', style: :compact, status: :none) do |p| %>
      <% p.with_title { t('school_groups.sub_nav.school_engagement') } %>
      <% p.with_link { link_to t('common.labels.view'), school_group_school_engagement_index_path(@school_group) } %>
      <%= t('school_groups.settings.engagement') %>
    <% end if SchoolGroups::SchoolEngagementController.show?(current_user) %>
  <% end %>
<% end %>

<%= render TitledSectionComponent.new(id: 'content-section', classes: 'scrollable-title') do |section| %>
  <% section.with_title do %>
    <h2><%= t('components.manage_school_navigation.content') %></h2>
  <% end %>
  <% section.with_body do %>
    <%= render PromptComponent.new(icon: 'tv', style: :compact, status: :none) do |p| %>
      <% p.with_title { t('manage_school_menu.digital_signage') } %>
      <% p.with_link { link_to t('common.labels.view'), school_group_digital_signage_index_path(@school_group) } %>
      <%= t('school_groups.settings.digital_signage') %>
    <% end %>
    <%= render PromptComponent.new(icon: 'timeline', style: :compact, status: :none) do |p| %>
      <% p.with_title { t('components.manage_school_navigation.history') } %>
      <% p.with_link { link_to t('common.labels.manage'), school_group_timeline_path(@school_group) } %>
      <%= t('school_groups.settings.history') %>
    <% end %>
  <% end %>
<% end %>
