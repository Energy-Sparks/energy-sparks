<%= render PageNavComponent.new name: t('advice_pages.nav.overview'),
                                classes: classes,
                                icon: nil, href: settings_school_group_path(school_group),
                                options: { user: current_user, match_controller: true } do |c| %>
  <% classes = 'small' %>

  <% c.with_section name: t('common.settings'),
                    icon: 'gear',
                    expanded: true,
                    visible: school_group.organisation?,
                    options: { match_controller: false } do |s| %>
    <% s.with_item(name: t('common.charts'),
                   href: school_group_chart_updates_path(school_group), classes:) %>
    <% s.with_item(name: t('common.clusters'),
                   href: school_group_clusters_path(school_group), classes:) %>
    <% if can? :manage, EnergyTariff %>
      <% s.with_item(name: t('common.tariffs'),
                     href: school_group_energy_tariffs_path(@school_group), classes:) %>
    <% end %>
  <% end %>

  <% c.with_section name: t('common.schools'),
                    icon: 'school',
                    expanded: true,
                    options: { match_controller: false } do |s| %>
    <%# s.with_item(name: t('common.status'),
                   href: '/', classes:) %>
    <% if school_group.organisation? %>
      <% s.with_item(name: t('manage_school_menu.digital_signage'),
                     href: school_group_digital_signage_index_path(school_group), classes:) %>
    <% end %>
    <% if SchoolGroups::SchoolEngagementController.show?(current_user) %>
      <% s.with_item(name: t('common.engagement'),
                     href: school_group_school_engagement_index_path(school_group), classes:) %>
    <% end %>
    <% if school_group.organisation? && Flipper.enabled?(:school_group_secr_report,  current_user) %>
      <% s.with_item(name: t('school_groups.sub_nav.secr_report'),
                     href: school_group_secr_index_path(school_group), classes:) %>
    <% end %>
    <% s.with_item(name: t('common.timeline'),
                   href: school_group_timeline_path(school_group), classes:) %>
  <% end %>

  <% c.with_section name: t('common.admin'),
                    icon: 'lock',
                    expanded: true,
                    visible: current_user.admin?,
                    options: { match_controller: false } do |s| %>
    <% s.with_item(name: t('school_groups.sub_nav.edit_group'),
                   href: edit_admin_school_group_path(school_group), classes:) %>
    <% if school_group.organisation? %>
      <% s.with_item(name: t('school_groups.sub_nav.group_admin'),
                     href: admin_school_group_path(school_group), classes:) %>
      <% s.with_item(name: 'Issues',
                     href: admin_school_group_issues_path(school_group), classes:) %>
    <% end %>
    <% s.with_item(name: t('school_groups.sub_nav.manage_users'),
                   href: admin_school_group_users_path(school_group), classes:) %>

    <% s.with_item(name: t('school_groups.sub_nav.manage_partners'),
                   href: admin_school_group_partners_path(school_group), classes:) %>
  <% end %>
<% end %>
