<%= render PageNavComponent.new name: t('advice_pages.nav.overview'),
                                classes: classes,
                                icon: nil, href: settings_school_group_path(school_group),
                                options: { user: current_user, match_controller: true } do |c| %>
  <% classes = 'small' %>

  <%# c.with_section name: 'Schools',
                    icon: 'school',
                    options: { match_controller: false } do |s| %>
# end %>

  <% c.with_section name: t('components.manage_school_navigation.settings'),
                    icon: 'gear',
                    expanded: false,
                    visible: school_group.organisation?,
                    options: { match_controller: false } do |s| %>
    <% s.with_item(name: t('school_groups.sub_nav.chart_settings'),
                   href: school_group_chart_updates_path(school_group), classes:) %>

    <% s.with_item(name: t('school_groups.sub_nav.clusters'),
                   href: school_group_clusters_path(school_group), classes:) %>
  <% end %>

  <% c.with_section name: t('components.manage_school_navigation.metering'),
                    icon: 'gauge',
                    expanded: false,
                    options: { match_controller: false } do |s| %>
    <% if can? :manage, EnergyTariff %>
      <% s.with_item(name: t('manage_school_menu.manage_tariffs'),
                     href: school_group_energy_tariffs_path(@school_group), classes:) %>
    <% end %>
  <% end %>

  <% c.with_section name: 'Reports',
                    icon: 'table',
                    expanded: false,
                    options: { match_controller: false } do |s| %>
    <% if Flipper.enabled?(:school_group_secr_report,  current_user) && school_group.organisation? %>
      <% s.with_item(name: t('school_groups.sub_nav.secr_report'),
                     href: school_group_secr_index_path(school_group), classes:) %>

    <% end %>
    <% if SchoolGroups::SchoolEngagementController.show?(current_user) %>
      <% s.with_item(name: t('school_groups.sub_nav.school_engagement'),
                     href: school_group_school_engagement_index_path(school_group), classes:) %>
    <% end %>
  <% end %>

  <% c.with_section name: t('components.manage_school_navigation.content'),
                    icon: 'folder',
                    expanded: false,
                    options: { match_controller: false } do |s| %>
    <% if school_group.organisation? %>
      <% s.with_item(name: t('manage_school_menu.digital_signage'),
                     href: school_group_digital_signage_index_path(school_group), classes:) %>
    <% end %>
    <% s.with_item(name: t('components.manage_school_navigation.history'),
                   href: school_group_timeline_path(school_group), classes:) %>
  <% end %>
  <% c.with_section name: t('components.manage_school_navigation.admin'),
                    icon: 'lock',
                    expanded: true,
                    visible: current_user.admin?,
                    options: { match_controller: false } do |s| %>
    <% s.with_item(name: t('school_groups.sub_nav.edit_group'),
                   href: edit_admin_school_group_path(school_group), classes:) %>

    <% s.with_item(name: t('school_groups.sub_nav.manage_users'),
                   href: admin_school_group_users_path(school_group), classes:) %>

    <% s.with_item(name: t('school_groups.sub_nav.manage_partners'),
                   href: admin_school_group_partners_path(school_group), classes:) %>

    <% if school_group.organisation? %>
      <% s.with_item(name: t('school_groups.sub_nav.group_admin'),
                     href: admin_school_group_path(school_group), classes:) %>
    <% end %>
  <% end %>
<% end %>
