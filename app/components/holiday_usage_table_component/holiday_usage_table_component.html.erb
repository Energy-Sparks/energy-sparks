<p><%= advice_t('gas_out_of_hours.analysis.holiday_usage.table_intro') %></p>

<table id="<%= @id %>" class="table advice-table">
  <thead>
    <tr>
      <th><%= t('calendar_event_type.holiday.title') %></th>
      <th><%= t('advice_pages.tables.columns.period') %></th>
      <th class="text-right"><%= t('common.table.columns.use_kwh') %></th>
      <th class="text-right"><%= advice_t('electricity_out_of_hours.analysis.tables.columns.average_daily_usage') %></th>
      <th class="text-right"><%= t('common.table.columns.cost_gbp') %></th>
      <th class="text-right"><%= t('common.table.columns.co2_kg') %></th>
    </tr>
  </thead>
  <tbody>
    <% school_periods.each do |holiday| %>
      <tr class='previous-holiday'>
        <td><%= I18nHelper.holiday(holiday.type) %></td>
        <td>
          <% if previous_holiday_usage(holiday).present? %>
            <%= t('analytics.from_and_to', from_date: previous_holiday_usage(holiday).start_date.to_s(:es_short), to_date: previous_holiday_usage(holiday).end_date.to_s(:es_short)) %>
          <% end %>
        </td>
        <% if previous_holiday_usage(holiday).present? %>
          <td class="text-right">
            <%= format_value(previous_holiday_usage(holiday).kwh, :kwh) %>
          </td>
          <td class="text-right">
            <%= format_value(average_daily_usage_previous_holiday(holiday), :kwh) %>
          </td>
          <td class="text-right">
            <%= format_value(previous_holiday_usage(holiday).£, :£) %>
          </td>
          <td class="text-right">
            <%= format_value(previous_holiday_usage(holiday).co2, :co2) %>
          </td>
        <% else %>
          <td colspan="4" class="text-center old-data">
            <%= t('advice_pages.not_enough_data.table_row_not_enough') %>
          </td>
        <% end %>
      </tr>

      <tr class='current-holiday'>
        <td></td>
        <td>
          <%= t('analytics.from_and_to', from_date: holiday.start_date.to_s(:es_short), to_date: holiday.end_date.to_s(:es_short)) %>
          <% if within_school_period?(holiday) %>
            <sup>*</sup>
          <% end %>
        </td>
        <% if usage(holiday).usage.present? %>
          <td class="text-right">
            <%= format_value(usage(holiday).usage.kwh, :kwh) %>
          </td>
          <td class="text-right">
            <%= format_value(average_daily_usage(usage(holiday).usage, holiday), :kwh) %>
          </td>
          <td class="text-right">
            <%= format_value(usage(holiday).usage.£, :£) %>
          </td>
          <td class="text-right">
            <%= format_value(usage(holiday).usage.co2, :co2) %>
          </td>
        <% else %>
          <td colspan="4" class="text-center old-data">
            <%= t('advice_pages.not_enough_data.table_row_not_enough') %>
          </td>
        <% end %>
      </tr>

      <% if can_compare_holiday_usage?(holiday, usage(holiday)) %>
        <tr class="table-active holiday-comparison">
          <td></td>
          <td><%= advice_t('baseload.tables.columns.percentage_difference')%></td>
          <td class="text-right">
            <%= format_unit(
              relative_percent(usage(holiday).previous_holiday_usage.kwh, usage(holiday).usage.kwh), :relative_percent) %>
          </td>
          <td class="text-right">
            <%= format_unit(
            relative_percent(average_daily_usage(usage(holiday).previous_holiday_usage, holiday),
                average_daily_usage(usage(holiday).usage, holiday)), :relative_percent) %>
          </td>
          <td class="text-right">
            <%= format_unit(
              relative_percent(usage(holiday).previous_holiday_usage.£, usage(holiday).usage.£), :relative_percent) %>
          </td>
          <td class="text-right">
            <%= format_unit(
              relative_percent(usage(holiday).previous_holiday_usage.co2, usage(holiday).usage.co2), :relative_percent) %>
          </td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>
<% if within_school_period?(school_periods.last) %>
  <div class="text-right advice-table-caption">
    <sup>*</sup> <%= t('advice_pages.tables.notice.partial_holiday') %>
  </div>
<% end %>
