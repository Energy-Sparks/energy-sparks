<%= tag.div id: id, class: classes do %>
  <div class="col">
    <div class="charts">
      <%= form_tag '', method: 'GET', id: 'chart-filter', class: 'form' do |f| %>
        <%= hidden_field_tag :configuration,
                             nil,
                             data: { configuration: default_configuration } %>

        <div class="form-row">
          <div class="form-group col-md-12">
            <span class="text-align-center mr-1">
              <strong><%= t('components.selectable_school_charts_component.chart_selection_fuel_type') %></strong>
            </span>
            <% @fuel_types.each_with_index do |fuel_type, index| %>
              <div class="custom-control custom-radio custom-control-inline">
                <input type="radio"
                       name="chart-selection-fuel-type"
                       id="chart-selection-fuel-type-<%= fuel_type %>"
                       data-fuel-type="<%= fuel_type %>"
                       class="custom-control-input"
                       <%= 'checked' if fuel_type == default_fuel_type %>>
                <label class="custom-control-label"
                       for="chart-selection-fuel-type-<%= fuel_type %>"
                       data-toggle="tooltip"
                       data-placement="top"
                       title="Change fuel type to <%= fuel_type %>">
                       <%= t(fuel_type, scope: 'common') %>
                </label>
              </div>
            <% end %>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-6">
            <strong><%= label_tag 'chart-selection-chart-type',
                                  t('components.selectable_school_charts_component.chart_selection_chart_type') %></strong>

            <select id="chart-selection-chart-type" name="chart-selection-chart-type" class='form-control select2'>
              <% @charts.each do |fuel_type, chart_config| %>
                <% next unless @fuel_types.include?(fuel_type) %>
                <% chart_config.each do |chart_type, config| %>
                  <option value="<%= chart_type %>"
                          data-fuel-type="<%= fuel_type %>"
                          data-title="<%= config[:title] || config[:label] %>"
                          data-subtitle="<%= config[:subtitle] || '' %>"
                          data-advice-page="<%= config[:advice_page] %>"
                          <%= 'selected' if chart_type == default_chart_type %>
                          <%= 'disabled hidden' unless fuel_type == default_fuel_type %>><%= config[:label] %></option>
                <% end %>
              <% end %>
            </select>
          </div>
          <div class="form-group col-md-6">
            <strong><%= label_tag 'chart-selection-school-id',
                                  t('components.selectable_school_charts_component.chart_selection_school_id') %></strong>
            <select id="chart-selection-school-id" name="chart-selection-school-id" class='form-control select2'>
              <% @schools.each do |school| %>
                <option value="<%= school.slug %>"
                        data-fuel-type="<%= fuel_types_for_school(school) %>"
                        data-name="<%= school.name %>"
                        <%= 'selected' if school == default_school %>
                        <%= 'disabled hidden' unless enable_school?(school) %>><%= school.name %></option>
              <% end %>
            </select>
          </div>
        </div>
      <% end %>
      <%= render ChartComponent.new chart_type: default_chart_type,
                                    axis_controls: true,
                                    analysis_controls: true,
                                    html_class: 'usage-chart',
                                    show_how_have_we_analysed_your_data: false,
                                    school: default_school do |c| %>
        <% c.with_title { default_chart_title } %>
        <% c.with_subtitle { default_chart_subtitle } %>
        <% c.with_header do %>
          <a class="chart-selection-analysis-link" href="<%= default_link %>">
            <%= t('components.selectable_school_charts_component.chart_selection_dynamic_footer.link') %>
          </a>
        <% end %>
      <% end %>
    </div>
  </div>
<% end %>
